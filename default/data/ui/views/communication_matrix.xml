<form>
  <label>Communication matrix</label>
  <fieldset submitButton="false">
    <input type="time" token="field2">
      <label></label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
    <input type="dropdown" token="dvc_ip" searchWhenChanged="true">
      <label>netflow probe</label>
      <choice value="*">*</choice>
      <search>
        <query>index=p0f sourcetype=netflow | fields dvc_ip|dedup dvc_ip |table dvc_ip</query>
        <earliest>-60m@m</earliest>
        <latest>now</latest>
      </search>
      <fieldForLabel>dvc_ip</fieldForLabel>
      <fieldForValue>dvc_ip</fieldForValue>
      <default>*</default>
    </input>
  </fieldset>
  <row>
    <panel>
      <table>
        <title>Top 10, src_ip x dest_ip</title>
        <search>
          <query>index=p0f sourcetype=netflow dvc_ip=$dvc_ip$  NOT (dest_port=2055 transport="udp") [search index=p0f sourcetype=netflow dvc_ip=$dvc_ip$ NOT (dest_port=2055 transport="udp") | stats count by src_ip,dest_ip,src_port,dest_port |top src_ip |table src_ip] [search index=p0f sourcetype=netflow dvc_ip=$dvc_ip$ NOT (dest_port=2055 transport="udp") | stats count by src_ip,dest_ip,src_port,dest_port |top dest_ip |table dest_ip] | stats count by src_ip,dest_ip |xyseries src_ip,dest_ip,count</query>
          <earliest>$field2.earliest$</earliest>
          <latest>$field2.latest$</latest>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="drilldown">row</option>
        <option name="dataOverlayMode">heatmap</option>
        <option name="count">10</option>
      </table>
    </panel>
    <panel>
      <table>
        <title>Top 10, src_ip x dest_port</title>
        <search>
          <query>index=p0f sourcetype=netflow dvc_ip=$dvc_ip$  NOT (dest_port=2055 transport="udp") [search index=p0f sourcetype=netflow dvc_ip=$dvc_ip$ NOT (dest_port=2055 transport="udp") | stats count by src_ip,dest_ip,src_port,dest_port |top src_ip |table src_ip] [search index=p0f sourcetype=netflow dvc_ip=$dvc_ip$ NOT (dest_port=2055 transport="udp") | stats count by src_ip,dest_ip,src_port,dest_port |top dest_port |table dest_port] | stats count by src_ip,dest_port |xyseries src_ip,dest_port,count</query>
          <earliest>$field2.earliest$</earliest>
          <latest>$field2.latest$</latest>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">heatmap</option>
        <option name="drilldown">cell</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
</form>